Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:02<00:04,  2.24s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:04<00:02,  2.18s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:05<00:00,  1.78s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:05<00:00,  1.89s/it]
/home/mdhaliwal/miniconda3/envs/test-llmrankers/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:590: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`. This was detected when initializing the generation config instance, which means the corresponding file may hold incorrect parameterization and should be fixed.
  warnings.warn(
/home/mdhaliwal/miniconda3/envs/test-llmrankers/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:595: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`. This was detected when initializing the generation config instance, which means the corresponding file may hold incorrect parameterization and should be fixed.
  warnings.warn(
/home/mdhaliwal/miniconda3/envs/test-llmrankers/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:590: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/mdhaliwal/miniconda3/envs/test-llmrankers/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:595: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
0it [00:00, ?it/s]2071it [00:00, 20645.00it/s]5038it [00:00, 25900.42it/s]8028it [00:00, 27717.99it/s]11013it [00:00, 28540.57it/s]13868it [00:00, 28047.08it/s]16675it [00:00, 27526.40it/s]20009it [00:00, 29349.18it/s]23011it [00:00, 29540.43it/s]25969it [00:00, 28881.96it/s]28863it [00:01, 28360.29it/s]31704it [00:01, 28110.08it/s]34518it [00:01, 27755.27it/s]37296it [00:01, 26688.21it/s]40081it [00:01, 27011.26it/s]43062it [00:01, 27818.19it/s]46041it [00:01, 28364.15it/s]49016it [00:01, 28767.98it/s]51899it [00:01, 28489.63it/s]54752it [00:01, 28033.59it/s]57560it [00:02, 26582.29it/s]60235it [00:02, 24974.95it/s]63028it [00:02, 25784.30it/s]65632it [00:02, 25665.04it/s]68216it [00:02, 25279.62it/s]71091it [00:02, 26266.85it/s]74076it [00:02, 27283.49it/s]77081it [00:02, 28064.09it/s]80071it [00:02, 28595.70it/s]83040it [00:03, 28912.15it/s]86019it [00:03, 29162.88it/s]88940it [00:03, 28990.17it/s]92011it [00:03, 29479.71it/s]95022it [00:03, 29655.57it/s]98012it [00:03, 29705.88it/s]101002it [00:03, 29756.04it/s]104002it [00:03, 29796.29it/s]106983it [00:03, 29167.51it/s]110014it [00:03, 29497.44it/s]113011it [00:04, 29613.79it/s]116020it [00:04, 29753.81it/s]119019it [00:04, 29821.97it/s]122021it [00:04, 29870.04it/s]125032it [00:04, 29929.22it/s]128034it [00:04, 29928.72it/s]131030it [00:04, 29933.56it/s]134034it [00:04, 29944.90it/s]137034it [00:04, 29927.90it/s]140027it [00:04, 28807.92it/s]143012it [00:05, 29093.62it/s]146014it [00:05, 29339.03it/s]149005it [00:05, 29498.98it/s]152015it [00:05, 29670.78it/s]155004it [00:05, 29717.94it/s]158012it [00:05, 29805.57it/s]161009it [00:05, 29832.00it/s]164006it [00:05, 29868.23it/s]167008it [00:05, 29911.11it/s]170000it [00:05, 29486.71it/s]172951it [00:06, 28372.99it/s]175798it [00:06, 27130.34it/s]178526it [00:06, 25693.78it/s]181116it [00:06, 24505.37it/s]184056it [00:06, 25811.92it/s]187025it [00:06, 26891.72it/s]189740it [00:06, 26720.27it/s]192430it [00:06, 25400.73it/s]195068it [00:06, 25647.45it/s]198038it [00:07, 26802.25it/s]200000it [00:07, 28181.26it/s]
  0%|          | 0/200 [00:00<?, ?it/s]/home/mdhaliwal/miniconda3/envs/test-llmrankers/lib/python3.9/site-packages/transformers/generation/utils.py:1493: UserWarning: You have modified the pretrained model configuration to control generation. This is a deprecated strategy to control generation and will be removed in v5. Please use and modify the model generation configuration (see https://huggingface.co/docs/transformers/generation_strategies#default-text-generation-configuration )
  warnings.warn(
/home/mdhaliwal/miniconda3/envs/test-llmrankers/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:590: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
  0%|          | 1/200 [01:30<4:59:40, 90.35s/it]  1%|          | 2/200 [02:56<4:49:54, 87.85s/it]  2%|▏         | 3/200 [04:17<4:38:02, 84.68s/it]  2%|▏         | 4/200 [06:09<5:12:14, 95.58s/it]  2%|▎         | 5/200 [06:50<4:06:06, 75.72s/it]  3%|▎         | 6/200 [08:30<4:31:41, 84.03s/it]  4%|▎         | 7/200 [10:02<4:38:56, 86.72s/it]  4%|▍         | 8/200 [11:10<4:18:28, 80.77s/it]  4%|▍         | 9/200 [12:35<4:21:25, 82.12s/it]  5%|▌         | 10/200 [14:01<4:23:45, 83.29s/it]  6%|▌         | 11/200 [15:41<4:38:02, 88.26s/it]  6%|▌         | 12/200 [17:10<4:37:08, 88.45s/it]  6%|▋         | 13/200 [18:37<4:34:49, 88.18s/it]  7%|▋         | 14/200 [20:16<4:43:24, 91.42s/it]  8%|▊         | 15/200 [21:50<4:43:53, 92.07s/it]  8%|▊         | 16/200 [23:27<4:47:28, 93.74s/it]  8%|▊         | 17/200 [24:50<4:36:03, 90.51s/it]  9%|▉         | 18/200 [26:17<4:31:04, 89.36s/it] 10%|▉         | 19/200 [27:34<4:18:02, 85.54s/it] 10%|█         | 20/200 [29:03<4:19:51, 86.62s/it] 10%|█         | 21/200 [30:31<4:19:45, 87.07s/it] 11%|█         | 22/200 [31:57<4:17:31, 86.81s/it] 12%|█▏        | 23/200 [32:46<3:42:16, 75.34s/it] 12%|█▏        | 24/200 [34:29<4:05:56, 83.84s/it] 12%|█▎        | 25/200 [36:06<4:15:32, 87.62s/it] 13%|█▎        | 26/200 [37:39<4:18:46, 89.23s/it] 14%|█▎        | 27/200 [39:21<4:28:37, 93.17s/it] 14%|█▍        | 28/200 [40:25<4:02:00, 84.42s/it] 14%|█▍        | 29/200 [41:53<4:03:38, 85.49s/it] 15%|█▌        | 30/200 [43:13<3:57:50, 83.95s/it] 16%|█▌        | 31/200 [44:26<3:46:41, 80.48s/it] 16%|█▌        | 32/200 [45:12<3:16:53, 70.32s/it] 16%|█▋        | 33/200 [45:52<2:50:07, 61.12s/it] 17%|█▋        | 34/200 [47:14<3:06:30, 67.41s/it] 18%|█▊        | 35/200 [48:53<3:30:57, 76.71s/it] 18%|█▊        | 36/200 [50:36<3:51:30, 84.70s/it] 18%|█▊        | 37/200 [52:17<4:03:18, 89.56s/it] 19%|█▉        | 38/200 [53:58<4:11:07, 93.01s/it] 20%|█▉        | 39/200 [55:32<4:10:22, 93.31s/it] 20%|██        | 40/200 [57:11<4:13:49, 95.19s/it] 20%|██        | 41/200 [58:46<4:11:43, 94.99s/it] 21%|██        | 42/200 [1:00:20<4:09:41, 94.82s/it] 22%|██▏       | 43/200 [1:01:57<4:09:14, 95.25s/it] 22%|██▏       | 44/200 [1:03:36<4:11:02, 96.55s/it] 22%|██▎       | 45/200 [1:05:21<4:15:58, 99.09s/it] 23%|██▎       | 46/200 [1:06:59<4:13:06, 98.61s/it] 24%|██▎       | 47/200 [1:08:32<4:07:29, 97.06s/it] 24%|██▍       | 48/200 [1:10:14<4:09:26, 98.46s/it] 24%|██▍       | 49/200 [1:11:47<4:03:45, 96.85s/it] 25%|██▌       | 50/200 [1:13:21<3:59:53, 95.96s/it] 26%|██▌       | 51/200 [1:14:43<3:47:40, 91.68s/it] 26%|██▌       | 52/200 [1:16:30<3:57:58, 96.48s/it] 26%|██▋       | 53/200 [1:18:05<3:55:06, 95.96s/it] 27%|██▋       | 54/200 [1:19:47<3:57:56, 97.78s/it] 28%|██▊       | 55/200 [1:20:46<3:28:22, 86.22s/it] 28%|██▊       | 56/200 [1:22:22<3:34:06, 89.21s/it] 28%|██▊       | 57/200 [1:23:33<3:19:28, 83.69s/it] 29%|██▉       | 58/200 [1:25:03<3:22:15, 85.46s/it] 30%|██▉       | 59/200 [1:26:34<3:24:36, 87.07s/it] 30%|███       | 60/200 [1:28:09<3:28:58, 89.56s/it] 30%|███       | 61/200 [1:29:41<3:29:07, 90.27s/it] 31%|███       | 62/200 [1:31:16<3:31:12, 91.83s/it] 32%|███▏      | 63/200 [1:32:32<3:18:18, 86.85s/it] 32%|███▏      | 64/200 [1:33:30<2:57:20, 78.24s/it] 32%|███▎      | 65/200 [1:34:57<3:01:59, 80.88s/it] 33%|███▎      | 66/200 [1:36:34<3:11:30, 85.75s/it] 34%|███▎      | 67/200 [1:37:50<3:03:51, 82.94s/it] 34%|███▍      | 68/200 [1:39:19<3:06:24, 84.73s/it] 34%|███▍      | 69/200 [1:40:47<3:07:07, 85.70s/it] 35%|███▌      | 70/200 [1:42:17<3:08:04, 86.81s/it] 36%|███▌      | 71/200 [1:43:58<3:16:15, 91.28s/it] 36%|███▌      | 72/200 [1:45:31<3:15:49, 91.79s/it] 36%|███▋      | 73/200 [1:47:05<3:15:47, 92.50s/it] 37%|███▋      | 74/200 [1:48:44<3:18:11, 94.37s/it] 38%|███▊      | 75/200 [1:50:03<3:07:04, 89.80s/it] 38%|███▊      | 76/200 [1:51:15<2:54:07, 84.26s/it] 38%|███▊      | 77/200 [1:52:43<2:55:12, 85.47s/it] 39%|███▉      | 78/200 [1:54:19<2:59:56, 88.49s/it] 40%|███▉      | 79/200 [1:55:37<2:52:25, 85.50s/it] 40%|████      | 80/200 [1:57:08<2:54:10, 87.09s/it] 40%|████      | 81/200 [1:58:32<2:51:07, 86.28s/it] 41%|████      | 82/200 [2:00:12<2:57:52, 90.44s/it] 42%|████▏     | 83/200 [2:01:14<2:39:13, 81.65s/it] 42%|████▏     | 84/200 [2:02:32<2:35:44, 80.56s/it] 42%|████▎     | 85/200 [2:04:09<2:43:54, 85.52s/it] 43%|████▎     | 86/200 [2:05:48<2:50:16, 89.62s/it] 44%|████▎     | 87/200 [2:07:10<2:44:23, 87.29s/it] 44%|████▍     | 88/200 [2:08:29<2:38:19, 84.82s/it] 44%|████▍     | 89/200 [2:09:52<2:36:05, 84.37s/it] 45%|████▌     | 90/200 [2:11:24<2:38:53, 86.67s/it] 46%|████▌     | 91/200 [2:12:48<2:35:54, 85.82s/it] 46%|████▌     | 92/200 [2:14:11<2:32:58, 84.99s/it] 46%|████▋     | 93/200 [2:15:21<2:23:45, 80.61s/it] 47%|████▋     | 94/200 [2:16:56<2:30:06, 84.97s/it] 48%|████▊     | 95/200 [2:18:24<2:30:10, 85.81s/it] 48%|████▊     | 96/200 [2:19:52<2:29:58, 86.52s/it] 48%|████▊     | 97/200 [2:20:50<2:13:25, 77.72s/it] 49%|████▉     | 98/200 [2:22:21<2:19:17, 81.93s/it] 50%|████▉     | 99/200 [2:24:00<2:26:08, 86.81s/it] 50%|█████     | 100/200 [2:25:25<2:24:01, 86.42s/it] 50%|█████     | 101/200 [2:26:41<2:17:32, 83.35s/it] 51%|█████     | 102/200 [2:28:21<2:24:15, 88.32s/it] 52%|█████▏    | 103/200 [2:29:56<2:25:55, 90.26s/it] 52%|█████▏    | 104/200 [2:31:24<2:23:18, 89.57s/it] 52%|█████▎    | 105/200 [2:32:55<2:22:17, 89.87s/it] 53%|█████▎    | 106/200 [2:34:16<2:17:01, 87.46s/it] 54%|█████▎    | 107/200 [2:35:59<2:22:24, 91.88s/it] 54%|█████▍    | 108/200 [2:37:24<2:17:54, 89.94s/it] 55%|█████▍    | 109/200 [2:38:51<2:15:17, 89.20s/it] 55%|█████▌    | 110/200 [2:40:27<2:16:27, 90.97s/it] 56%|█████▌    | 111/200 [2:41:58<2:15:09, 91.12s/it] 56%|█████▌    | 112/200 [2:43:26<2:12:07, 90.08s/it] 56%|█████▋    | 113/200 [2:44:41<2:04:10, 85.64s/it] 57%|█████▋    | 114/200 [2:46:11<2:04:38, 86.96s/it] 57%|█████▊    | 115/200 [2:46:43<1:39:42, 70.38s/it] 58%|█████▊    | 116/200 [2:47:29<1:28:26, 63.17s/it] 58%|█████▊    | 117/200 [2:48:25<1:24:13, 60.89s/it] 59%|█████▉    | 118/200 [2:49:58<1:36:21, 70.50s/it] 60%|█████▉    | 119/200 [2:51:30<1:43:56, 77.00s/it] 60%|██████    | 120/200 [2:53:01<1:48:26, 81.33s/it] 60%|██████    | 121/200 [2:54:13<1:43:23, 78.52s/it] 61%|██████    | 122/200 [2:55:48<1:48:24, 83.39s/it] 62%|██████▏   | 123/200 [2:57:23<1:51:34, 86.94s/it] 62%|██████▏   | 124/200 [2:59:00<1:53:46, 89.82s/it] 62%|██████▎   | 125/200 [3:00:24<1:50:08, 88.11s/it] 63%|██████▎   | 126/200 [3:01:40<1:44:13, 84.51s/it] 64%|██████▎   | 127/200 [3:02:22<1:27:13, 71.69s/it] 64%|██████▍   | 128/200 [3:04:08<1:38:31, 82.11s/it] 64%|██████▍   | 129/200 [3:04:50<1:22:49, 70.00s/it] 65%|██████▌   | 130/200 [3:06:29<1:31:47, 78.68s/it] 66%|██████▌   | 131/200 [3:08:01<1:35:00, 82.62s/it] 66%|██████▌   | 132/200 [3:09:21<1:32:59, 82.05s/it] 66%|██████▋   | 133/200 [3:10:53<1:34:50, 84.93s/it] 67%|██████▋   | 134/200 [3:12:12<1:31:34, 83.25s/it] 68%|██████▊   | 135/200 [3:13:13<1:23:01, 76.63s/it] 68%|██████▊   | 136/200 [3:14:54<1:29:18, 83.73s/it] 68%|██████▊   | 137/200 [3:16:23<1:29:33, 85.30s/it] 69%|██████▉   | 138/200 [3:18:01<1:32:15, 89.29s/it] 70%|██████▉   | 139/200 [3:19:41<1:33:49, 92.29s/it] 70%|███████   | 140/200 [3:21:04<1:29:33, 89.55s/it] 70%|███████   | 141/200 [3:22:39<1:29:38, 91.16s/it] 71%|███████   | 142/200 [3:23:49<1:22:08, 84.97s/it] 72%|███████▏  | 143/200 [3:24:52<1:14:17, 78.20s/it] 72%|███████▏  | 144/200 [3:26:25<1:17:07, 82.63s/it] 72%|███████▎  | 145/200 [3:27:59<1:19:00, 86.19s/it] 73%|███████▎  | 146/200 [3:29:20<1:16:15, 84.73s/it] 74%|███████▎  | 147/200 [3:30:52<1:16:45, 86.90s/it] 74%|███████▍  | 148/200 [3:32:22<1:15:55, 87.60s/it] 74%|███████▍  | 149/200 [3:32:52<59:50, 70.40s/it]   75%|███████▌  | 150/200 [3:34:23<1:03:56, 76.73s/it] 76%|███████▌  | 151/200 [3:35:50<1:05:11, 79.83s/it] 76%|███████▌  | 152/200 [3:37:19<1:05:56, 82.42s/it] 76%|███████▋  | 153/200 [3:38:52<1:07:00, 85.54s/it] 77%|███████▋  | 154/200 [3:40:05<1:02:42, 81.79s/it] 78%|███████▊  | 155/200 [3:41:02<55:49, 74.43s/it]   78%|███████▊  | 156/200 [3:42:22<55:46, 76.07s/it] 78%|███████▊  | 157/200 [3:43:58<58:43, 81.95s/it] 79%|███████▉  | 158/200 [3:45:27<58:55, 84.18s/it] 80%|███████▉  | 159/200 [3:47:01<59:36, 87.22s/it] 80%|████████  | 160/200 [3:48:31<58:42, 88.07s/it] 80%|████████  | 161/200 [3:50:01<57:35, 88.59s/it] 81%|████████  | 162/200 [3:51:36<57:18, 90.50s/it] 82%|████████▏ | 163/200 [3:52:36<50:14, 81.47s/it] 82%|████████▏ | 164/200 [3:54:04<50:03, 83.42s/it] 82%|████████▎ | 165/200 [3:55:41<50:59, 87.41s/it] 83%|████████▎ | 166/200 [3:57:14<50:28, 89.08s/it] 84%|████████▎ | 167/200 [3:58:22<45:31, 82.78s/it] 84%|████████▍ | 168/200 [3:59:38<43:02, 80.71s/it] 84%|████████▍ | 169/200 [4:01:05<42:39, 82.57s/it] 85%|████████▌ | 170/200 [4:01:36<33:31, 67.04s/it] 86%|████████▌ | 171/200 [4:03:05<35:41, 73.84s/it] 86%|████████▌ | 172/200 [4:03:37<28:35, 61.25s/it] 86%|████████▋ | 173/200 [4:05:21<33:14, 73.86s/it] 87%|████████▋ | 174/200 [4:06:53<34:21, 79.27s/it] 88%|████████▊ | 175/200 [4:08:16<33:35, 80.63s/it] 88%|████████▊ | 176/200 [4:09:57<34:39, 86.67s/it] 88%|████████▊ | 177/200 [4:11:45<35:39, 93.02s/it] 89%|████████▉ | 178/200 [4:13:17<33:58, 92.64s/it] 90%|████████▉ | 179/200 [4:14:43<31:45, 90.74s/it] 90%|█████████ | 180/200 [4:16:33<32:09, 96.48s/it] 90%|█████████ | 181/200 [4:18:16<31:13, 98.61s/it] 91%|█████████ | 182/200 [4:19:53<29:22, 97.94s/it] 92%|█████████▏| 183/200 [4:21:33<27:56, 98.60s/it] 92%|█████████▏| 184/200 [4:23:02<25:31, 95.71s/it] 92%|█████████▎| 185/200 [4:24:40<24:04, 96.30s/it] 93%|█████████▎| 186/200 [4:26:11<22:08, 94.86s/it] 94%|█████████▎| 187/200 [4:27:00<17:34, 81.11s/it] 94%|█████████▍| 188/200 [4:28:27<16:34, 82.84s/it] 94%|█████████▍| 189/200 [4:30:00<15:45, 85.99s/it] 95%|█████████▌| 190/200 [4:31:39<14:57, 89.73s/it] 96%|█████████▌| 191/200 [4:32:46<12:27, 83.02s/it] 96%|█████████▌| 192/200 [4:33:10<08:42, 65.37s/it] 96%|█████████▋| 193/200 [4:34:51<08:50, 75.85s/it] 97%|█████████▋| 194/200 [4:36:18<07:55, 79.33s/it] 98%|█████████▊| 195/200 [4:37:51<06:57, 83.41s/it] 98%|█████████▊| 196/200 [4:39:26<05:47, 86.77s/it] 98%|█████████▊| 197/200 [4:40:43<04:11, 83.83s/it] 99%|█████████▉| 198/200 [4:42:06<02:47, 83.64s/it]100%|█████████▉| 199/200 [4:43:43<01:27, 87.66s/it]100%|██████████| 200/200 [4:45:19<00:00, 90.26s/it]100%|██████████| 200/200 [4:45:19<00:00, 85.60s/it]
Avg comparisons: 827.74
Avg prompt tokens: 469552.71
Avg completion tokens: 471208.19
Avg time per query: 85.59849534988403
